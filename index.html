<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RoomCrick - Green Theme</title>
  <link rel="icon" href="https://img.icons8.com/color/96/cricket.png" type="image/png" />
  <meta name="theme-color" content="#1b5e20" />

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
body {
  background: linear-gradient(to bottom, #3b8d4c, #1b5e20);
  color: #ffffff;
  font-family: 'Inter', sans-serif;
}

h1, h2, h3, h4, #matchTeams, #inningLabel, .text-lg, .font-semibold, #summary, #history, #overSummary, #matchInnings {
  color: #ffffff;
}

input, select {
  background-color: #e8f5e9;
  color: #1b5e20;
  border: 2px solid #66bb6a;
  padding: 0.5rem;
  border-radius: 6px;
}

button, .btn {
  background-color: #388e3c;
  color: #ffffff;
  border-radius: 6px;
  padding: 0.5rem 1rem;
}

button:hover, .btn:hover {
  background-color: #2e7d32;
}

.bg-white {
  background-color: rgba(255, 255, 255, 0.1) !important;
  border: 1px solid #ffffff33;
  padding: 1rem;
  border-radius: 8px;
  color: #ffffff;
}

#matchPanel, #scoreboard, #summary, #history, #overSummary, #matchInnings {
  background-color: rgba(0, 0, 0, 0.7);
  color: #ffffff;
  border-radius: 10px;
  padding: 1rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
}

#tossResultText {
  color: #ffeb3b;
  font-weight: bold;
}

table th, table td {
  border: 1px solid #4caf50;
  padding: 0.4rem;
  color: #ffffff;
}

footer {
  color: #c8e6c9;
}

.text-black, .text-gray-800, .text-gray-700 {
  color: #ffffff !important;
}

input, select {
  color: #1b5e20 !important;
}

#targetInfo, #oversLeft, #runRate {
  color: #fff700 !important;
  font-weight: bold;
}
  /* üéØ Coin Flip Animation */
  @keyframes flipCoin {
      0% { transform: rotateY(0); }
      50% { transform: rotateY(1800deg); }
      100% { transform: rotateY(3600deg); }
    }
    .flip-animation {
      animation: flipCoin 1s ease-out forwards;
    }
</style>
</head>
<body class="bg-white text-gray-800 font-sans p-4 max-w-xl mx-auto">
  <h1 class="text-3xl font-bold mb-4 text-center">üèè RoomCrick</h1>

  <!-- Toss Section -->
<body class="bg-gradient-to-br from-blue-100 via-green-100 to-yellow-100 min-h-screen flex items-center justify-center p-4 font-sans">

  <!-- ü™ô Toss Section -->
  <div class="p-6 bg-white shadow-2xl rounded-2xl w-full max-w-md border border-gray-200">
    <h2 class="text-2xl font-bold mb-4 text-center text-green-700">ü™ô RoomCrick Toss</h2>

    <!-- Team Inputs -->
    <div class="grid sm:grid-cols-2 gap-4">
      <label class="block">
        <span class="text-sm font-medium text-gray-700">Team A</span>
        <input id="teamA" class="w-full mt-1 text-black p-2 rounded border border-gray-300" placeholder="Enter Team A" />
      </label>
      <label class="block">
        <span class="text-sm font-medium text-gray-700">Team B</span>
        <input id="teamB" class="w-full mt-1 text-black p-2 rounded border border-gray-300" placeholder="Enter Team B" />
      </label>
    </div>

    <!-- Toss Call & Choice -->
    <div class="mt-4">
      <label class="block text-gray-700">Your Call:
        <select id="userCall" class="text-black mt-1 w-full p-2 rounded border border-gray-300">
          <option value="Heads">Heads</option>
          <option value="Tails">Tails</option>
        </select>
      </label>

      <label class="block mt-2 text-gray-700">Your Choice:
        <select id="userChoice" class="text-black mt-1 w-full p-2 rounded border border-gray-300">
          <option value="Bat">Bat</option>
          <option value="Bowl">Bowl</option>
        </select>
      </label>
    </div>

    <!-- Toss Buttons -->
    <div class="flex flex-wrap justify-center gap-2 mt-4">
      <button class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded text-white" onclick="simulateToss()">ü™ô Toss Coin</button>
      <button class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded text-white" onclick="resetToss()">‚ôªÔ∏è Re-Toss</button>
      <button class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded text-white" onclick="skipToss()">üéØ Skip Toss</button>
    </div>

    <!-- Coin & Result -->
    <div class="mt-6">
      <div id="coin" class="w-24 h-24 sm:w-28 sm:h-28 mx-auto bg-yellow-300 text-black flex items-center justify-center text-4xl font-bold rounded-full border-4 border-white transition-transform duration-500">
        ü™ô
      </div>
      <p id="tossResultText" class="text-center mt-4 font-bold text-lg text-gray-800"></p>
    </div>
  </div>
  <!-- Match Settings & Controls -->
  <div class="space-y-6 bg-gray-50 p-4 rounded shadow-md mt-6">
    <!-- Overs and Wickets -->
    <div class="grid sm:grid-cols-2 gap-4">
      <label class="block">
        <span class="text-sm font-medium">Overs</span>
        <input id="totalOvers" class="input w-full mt-1" type="number" min="1" placeholder="e.g. 5" />
      </label>
      <label class="block">
        <span class="text-sm font-medium">Wickets</span>
        <input id="totalWickets" class="input w-full mt-1" type="number" min="1" value="10" />
      </label>
    </div>

    <!-- Commentary Language -->
    <div class="block">
      <span class="text-sm font-medium">üé§ Commentary Language</span>
      <select id="voiceLang" class="input w-full mt-1">
        <option value="en-US">English</option>
        <option value="hi-IN">Hindi</option>
        <option value="ta-IN">Tamil</option>
        <option value="te-IN">Telugu</option>
      </select>
    </div>

    <!-- Control Buttons -->
    <div class="flex flex-wrap gap-2 justify-center sm:justify-start mt-2">
      <button onclick="startMatch()" class="btn bg-blue-600 hover:bg-blue-700">Start Match</button>
      <button onclick="enableAudio()" class="btn bg-green-600 hover:bg-green-700">üîä Enable Audio</button>
      <button onclick="toggleMute()" id="muteBtn" class="btn bg-gray-600 hover:bg-gray-700">üîä Mute</button>
      <button onclick="clearHistory()" class="btn bg-red-500 hover:bg-red-600">üóëÔ∏è Clear History</button>
      <button id="toggleMatchInningsBtn" onclick="toggleMatchInnings()" class="btn bg-yellow-500 hover:bg-yellow-600">Show Match Innings</button>
      <button id="startSecondInningsBtn" onclick="startSecondInnings()" class="btn bg-green-500 hover:bg-green-600 hidden">‚û°Ô∏è Start Second Innings</button>
    </div>

    <!-- Umpire and Maiden messages -->
    <div id="umpireCall" class="hidden text-center text-2xl font-bold mt-2 text-red-600"></div>
    <div id="maidenMessage" class="hidden text-center text-green-600 text-xl font-bold mt-2"></div>
  </div>
  <!-- Match Panel -->
  <div id="matchPanel" class="hidden space-y-4 mt-6">
    <div class="text-lg font-semibold">üèè Match: <span id="matchTeams"></span> <span id="inningLabel">(1st Innings)</span></div>
    <div class="text-md">
      <div id="targetInfo" class="font-semibold text-green-700 mb-1"></div>
      Score: <span id="score">0/0</span><br />
      Overs: <span id="overs">0.0</span><br />
      Run Rate: <span id="runRate">0.00</span><br />
      Overs Left: <span id="oversLeft">0.0</span>
    </div>

    <!-- Scoring Buttons -->
    <div class="grid grid-cols-3 gap-2 mt-4">
      <button onclick="addRun(0)" class="scoring-btn btn">Dot</button>
      <button onclick="addRun(1)" class="scoring-btn btn">1</button>
      <button onclick="addRun(2)" class="scoring-btn btn">2</button>
      <button onclick="addRun(3)" class="scoring-btn btn">3</button>
      <button onclick="addRun(4)" class="scoring-btn btn">4</button>
      <button onclick="addRun(6)" class="scoring-btn btn">6</button>
      <button onclick="addWide()" class="scoring-btn btn bg-yellow-400">Wide</button>
      <button onclick="addLegBye()" class="scoring-btn btn bg-green-400">Leg Bye</button>
      <button onclick="addWicket()" class="scoring-btn btn bg-red-500 hover:bg-red-600 col-span-3 sm:col-span-2">Wicket</button>
    </div>

    <!-- Action Buttons -->
    <div class="space-x-2 mt-4">
      <button onclick="undoLastBall()" class="btn bg-gray-400">Undo</button>
      <button id="endMatchBtn" onclick="endMatch()" class="btn bg-gray-600 hover:bg-gray-700">End Match</button>
    </div>
  </div>

  <!-- Scoreboard Section -->
  <div id="scoreboard" class="mt-6 hidden">
    <h2 class="text-xl font-semibold mb-2">Full Scoreboard</h2>

    <h3 class="text-lg font-semibold">Batsmen</h3>
    <table class="w-full text-sm mb-4 border">
      <thead>
        <tr class="bg-gray-100">
          <th class="border px-2">Name</th>
          <th class="border px-2">Runs</th>
          <th class="border px-2">Balls</th>
          <th class="border px-2">Dots</th>
          <th class="border px-2">4s</th>
          <th class="border px-2">6s</th>
          <th class="border px-2">Status</th>
        </tr>
      </thead>
      <tbody id="batsmanTable"></tbody>
    </table>

    <h3 class="text-lg font-semibold">Bowlers</h3>
    <table class="w-full text-sm border">
      <thead>
        <tr class="bg-gray-100">
          <th class="border px-2">Name</th>
          <th class="border px-2">Overs</th>
          <th class="border px-2">Runs</th>
          <th class="border px-2">Dots</th>
          <th class="border px-2">Wickets</th>
        </tr>
      </thead>
      <tbody id="bowlerTable"></tbody>
    </table>
  </div>

  <!-- Over Summary -->
  <div id="overSummary" class="mt-6 space-y-2"></div>

  <!-- Inning-wise Highlights -->
  <div id="matchInnings" class="mt-6 space-y-4"></div>

  <!-- Match Summary -->
  <div id="summary" class="mt-6 hidden">
    <h3 class="font-bold text-lg mb-2">üèÅ Match Summary</h3>
    <p id="winner"></p>
    <div id="highlights" class="mt-4 text-sm text-left text-gray-800"></div>
    <div id="playAgainContainer" class="mt-4"></div>
  </div>

  <!-- Match History -->
  <div id="history" class="mt-6">
    <h3 class="font-bold text-lg mb-2">üìú Past Matches</h3>
    <ul id="matchHistory" class="list-disc pl-5 space-y-1"></ul>
  </div>

  <!-- Manifest and Main JS -->
  <link rel="manifest" href="manifest.json?v=7" />
  <script src="main.js?v=7"></script>

  <!-- Footer -->
  <div class="text-center text-xs text-gray-500 mt-6">
    RoomCrick v7 ‚Äì Always updated üöÄ
  </div>
</body>
</html>
<script>
    let teamA = "", teamB = "", tossWinner = "", tossDecision = "", audioEnabled = true;

    function speakCommentary(text) {
      if (!audioEnabled) return;
      const msg = new SpeechSynthesisUtterance(text);
      msg.lang = document.getElementById("voiceLang").value;
      window.speechSynthesis.speak(msg);
    }

    function simulateToss() {
  const coin = document.getElementById("coin");
  const resultText = document.getElementById("tossResultText");

  // ‚úÖ Play Toss Sound
  const tossSound = document.getElementById("soundToss");
  if (tossSound && !isMuted) {
    tossSound.currentTime = 0;
    tossSound.play();
  }

  coin.classList.remove("flip-animation");
  void coin.offsetWidth;
  coin.classList.add("flip-animation");

  teamA = document.getElementById("teamA").value.trim() || "Team A";
  teamB = document.getElementById("teamB").value.trim() || "Team B";

  const userCall = document.getElementById("userCall").value;
  const userChoice = document.getElementById("userChoice").value;
  const tossResult = Math.random() < 0.5 ? "Heads" : "Tails";

  setTimeout(() => {
    resultText.innerText = `ü™ô It's ${tossResult}!`;

    if (userCall === tossResult) {
      tossWinner = teamA;
      tossDecision = userChoice;
    } else {
      tossWinner = teamB;
      tossDecision = Math.random() < 0.5 ? "Bat" : "Bowl";
    }

    resultText.innerText += `\nüèÜ ${tossWinner} won the toss and chose to ${tossDecision} first.`;
    localStorage.setItem("tossWinner", tossWinner);
    localStorage.setItem("tossDecision", tossDecision);

    speakCommentary(`${tossWinner} won the toss and chose to ${tossDecision.toLowerCase()} first.`);
    confetti();
  }, 1000);
}
let totalWickets = 10;
let history = JSON.parse(localStorage.getItem('crickHistory') || '[]');
let inning = 1;
let firstInningsScore = 0;
let totalOvers = 0;

let score = 0;
let wickets = 0;
let balls = 0;
let extras = 0;
let legByeCount = 0;
let dots = 0;

let batsmen = [];
let bowlers = [];
let currentBatsmanIndex = 0;
let currentBowlerIndex = 0;
let ballHistory = [];
let inningsHistory = [[], []];
let currentInnings = 0;

// Load match state
window.onload = function () {
  const savedState = localStorage.getItem("RoomCrickState");
  if (savedState) {
    const state = JSON.parse(savedState);
    score = state.score;
    wickets = state.wickets;
    balls = state.balls;
    totalOvers = state.totalOvers;
    legByeCount = state.legByeCount;
    batsmen = state.batsmen;
    bowlers = state.bowlers;
    currentBatsmanIndex = state.currentBatsmanIndex;
    currentBowlerIndex = state.currentBowlerIndex;
    inning = state.inning;
    firstInningsScore = state.firstInningsScore;
    extras = state.extras || 0;
    ballHistory = state.ballHistory || [];

    document.getElementById("teamA").value = state.teamA;
    document.getElementById("teamB").value = state.teamB;
    document.getElementById("totalOvers").value = state.totalOvers;

    document.getElementById("matchPanel").classList.remove("hidden");
    document.getElementById("scoreboard").classList.remove("hidden");
    document.getElementById("matchTeams").textContent = `${state.teamA} vs ${state.teamB}`;
    document.getElementById("inningLabel").textContent = `(Innings ${inning})`;
    if (inning === 2) {
      document.getElementById("targetInfo").textContent = `Target: ${firstInningsScore + 1} to win`;
    }

    updateDisplay();
    renderScoreboard();
  }
};

function saveMatchState() {
  const matchState = {
    score, wickets, balls, totalOvers, legByeCount,
    batsmen, bowlers, currentBatsmanIndex, currentBowlerIndex,
    inning, firstInningsScore, extras, ballHistory, dots,
    teamA: document.getElementById("teamA").value.trim(),
    teamB: document.getElementById("teamB").value.trim()
  };
  localStorage.setItem("RoomCrickState", JSON.stringify(matchState));
}

function clearMatchState() {
  localStorage.removeItem("RoomCrickState");
}

function startMatch() {
  clearMatchState();

  teamA = document.getElementById("teamA").value.trim();
  teamB = document.getElementById("teamB").value.trim();
  totalOvers = parseInt(document.getElementById("totalOvers").value);
  totalWickets = parseInt(document.getElementById("totalWickets").value) || 10;

  if (!teamA || !teamB || isNaN(totalOvers) || totalOvers <= 0) {
    alert("Please enter valid team names and overs.");
    return;
  }

  // Reset all match variables
  inningsHistory = [[]];
  currentInnings = 0;
  inning = 1;
  firstInningsScore = 0;
  score = 0;
  wickets = 0;
  balls = 0;
  extras = 0;
  legByeCount = 0;
  dots = 0;
  ballHistory = [];
  batsmen = [];
  bowlers = [];
  currentBatsmanIndex = 0;
  currentBowlerIndex = 0;

  document.getElementById("targetInfo").textContent = "";

  // Prompt for player names
  let striker = prompt("Enter name of batsman:") || "Batsman 1";
  let bowlerName = prompt("Enter name of opening bowler:") || "Bowler 1";

  batsmen.push({ name: striker, runs: 0, balls: 0, fours: 0, sixes: 0, dotBalls: 0, out: false });
  bowlers.push({ name: bowlerName, balls: 0, runs: 0, dotBalls: 0, wickets: 0 });

  // Show match panel
  document.getElementById("matchPanel").classList.remove("hidden");
  document.getElementById("scoreboard").classList.remove("hidden");
  document.getElementById("summary").classList.add("hidden");

  document.getElementById("matchTeams").textContent = `${teamA} vs ${teamB}`;
  document.getElementById("inningLabel").textContent = `(1st Innings)`;

  // Update everything
  updateDisplay();
  renderScoreboard();
  renderHistory();
  saveMatchState();
  renderOverSummary();
}
    function playRunSound(runs) {
  const sounds = {
    0: document.getElementById("soundDot"),
    1: document.getElementById("sound1"),
    2: document.getElementById("sound2"),
    4: document.getElementById("sound4"),
    6: document.getElementById("sound6")
  };
  if (sounds[runs]) {
    sounds[runs].currentTime = 0;
    sounds[runs].play();
  }
}

function addRun(runs) {
  if (isInningsOver()) return alert("Innings is over.");

  const striker = batsmen[currentBatsmanIndex];
  const bowler = bowlers[currentBowlerIndex];

  score += runs;
  striker.runs += runs;
  striker.balls++;
  bowler.runs += runs;
  balls++;
  bowler.balls++;

  if (runs === 0) {
    striker.dotBalls++;
    bowler.dotBalls++;
    dots++;
  }
  if (runs === 4) striker.fours++;
  if (runs === 6) striker.sixes++;

  // üîä Sound + Commentary
  playRunSound(runs);
  if (runs === 0) speakCommentary("dot");
  if (runs === 1) speakCommentary("one");
  if (runs === 2) speakCommentary("two");
  if (runs === 4) speakCommentary("four");
  if (runs === 6) speakCommentary("six");

  // üîô Undo History
  ballHistory.push({
    type: 'run',
    runs,
    strikerIndex: currentBatsmanIndex,
    bowlerIndex: currentBowlerIndex,
    wicketsBefore: wickets,
    ballsBefore: balls - 1,
    scoreBefore: score - runs,
    batsmenBefore: JSON.stringify(batsmen),
    bowlersBefore: JSON.stringify(bowlers),
    ballNumber: balls - 1
  });

  // ‚úÖ ‚úÖ ‚úÖ Ensure innings array exists
  if (!inningsHistory[currentInnings]) inningsHistory[currentInnings] = [];

  // ‚úÖ ‚úÖ ‚úÖ Push this run event to correct innings
  inningsHistory[currentInnings].push({
    type: 'run',
    runs,
    over: Math.floor(balls / 6),
    ball: balls % 6,
    batsman: striker.name,
    bowler: bowler.name,
    score,
    wickets
  });

  // ‚è≠ Updates
  checkOverComplete();
  updateDisplay();
  renderScoreboard();
  checkInningsEnd();
  checkTargetReached();
  saveMatchState();
  renderOverSummary();
}
function addWide() {
  if (isInningsOver()) return alert("Innings is over.");

  score++;
  extras++;

  const bowler = bowlers[currentBowlerIndex];
  const striker = batsmen[currentBatsmanIndex];

  bowler.runs++;

  if (!isMuted) {
    const wideSound = document.getElementById("soundWide");
    if (wideSound) {
      wideSound.currentTime = 0;
      wideSound.play();
    }
    showUmpireCall("wide");
  }

  speakCommentary("wide");

  // üîô Save for undo
  ballHistory.push({
    type: 'wide',
    runs: 1,
    strikerIndex: currentBatsmanIndex,
    bowlerIndex: currentBowlerIndex,
    wicketsBefore: wickets,
    ballsBefore: balls, // Wide doesn't increase balls
    scoreBefore: score - 1,
    batsmenBefore: JSON.stringify(batsmen),
    bowlersBefore: JSON.stringify(bowlers),
    ballNumber: balls - 1
  });

  // ‚úÖ Ensure innings array exists for current innings (0 for 1st, 1 for 2nd innings)
  if (!inningsHistory[currentInnings]) inningsHistory[currentInnings] = [];

  // ‚úÖ Record wide event in correct innings
  inningsHistory[currentInnings].push({
    type: 'wide',
    runs: 1,
    over: Math.floor(balls / 6),
    ball: balls % 6,
    batsman: striker.name,
    bowler: bowler.name,
    score,
    wickets
  });

  updateDisplay();
  renderScoreboard();
  checkInningsEnd();
  checkTargetReached();
  saveMatchState();
  renderOverSummary();
}
function addLegBye() {
  if (isInningsOver()) return alert("Innings is over.");

  legByeCount++;
  const bowler = bowlers[currentBowlerIndex];
  const batsman = batsmen[currentBatsmanIndex];

  balls++;
  bowler.balls++;
  batsman.dotBalls++;

  speakCommentary("legbye");

  if (!isMuted) {
    const legByeSound = document.getElementById("soundLegBye");
    if (legByeSound) {
      legByeSound.currentTime = 0;
      legByeSound.play();
    }
  }

  // üîÅ Save for undo
  ballHistory.push({
    type: 'legbye',
    strikerIndex: currentBatsmanIndex,
    bowlerIndex: currentBowlerIndex,
    ballsBefore: balls - 1,
    scoreBefore: score,
    legByeCountBefore: legByeCount - 1,
    batsmenBefore: JSON.stringify(batsmen),
    bowlersBefore: JSON.stringify(bowlers),
    ballNumber: balls - 1
  });

  // ‚úÖ Ensure innings array exists
  if (!inningsHistory[currentInnings]) inningsHistory[currentInnings] = [];

  // ‚úÖ Push leg bye event to correct innings highlights
  inningsHistory[currentInnings].push({
    type: 'legbye',
    over: Math.floor(balls / 6),
    ball: balls % 6,
    batsman: batsman.name,
    bowler: bowler.name,
    score,
    wickets
  });

  // üü• Custom rule: 3 leg byes = Out
  if (legByeCount >= 3) {
    legByeCount = 0;
    wickets++;
    batsman.out = true;
    bowler.wickets++;

    showUmpireCall("wicket");
    speakCommentary("wicket");

    const wicketSound = document.getElementById("soundWicket");
    if (!isMuted && wicketSound) {
      wicketSound.currentTime = 0;
      wicketSound.play();
    }

    alert(`${batsman.name} is OUT after 3 leg byes!`);

    // ‚úÖ Push this wicket event (due to leg byes) into correct innings
    if (!inningsHistory[currentInnings]) inningsHistory[currentInnings] = [];
    inningsHistory[currentInnings].push({
      type: 'wicket (legbye)',
      over: Math.floor(balls / 6),
      ball: balls % 6,
      batsman: batsman.name,
      bowler: bowler.name,
      score,
      wickets
    });

    if (wickets < totalWickets) {
      let newBatsman = prompt("Enter name of new batsman:");
      if (!newBatsman) newBatsman = `Batsman ${wickets + 1}`;
      batsmen.push({
        name: newBatsman,
        runs: 0,
        balls: 0,
        fours: 0,
        sixes: 0,
        dotBalls: 0,
        out: false
      });
      currentBatsmanIndex = batsmen.length - 1;
    } else {
      alert("All out!");
    }
  }

  updateDisplay();
  renderScoreboard();
  checkOverComplete();
  checkInningsEnd();
  checkTargetReached();
  saveMatchState();
  renderOverSummary();
}

function addWicket() {
  if (isInningsOver()) return alert("Innings is over.");

  wickets++;
  balls++;
  const bowler = bowlers[currentBowlerIndex];
  const batsman = batsmen[currentBatsmanIndex];

  bowler.balls++;
  bowler.wickets++;
  batsman.out = true;
  legByeCount = 0; // üîÅ Reset leg bye counter after wicket

  // üîô Save for Undo
  ballHistory.push({
    type: 'wicket',
    strikerIndex: currentBatsmanIndex,
    bowlerIndex: currentBowlerIndex,
    wicketsBefore: wickets - 1,
    ballsBefore: balls - 1,
    scoreBefore: score,
    batsmenBefore: JSON.stringify(batsmen),
    bowlersBefore: JSON.stringify(bowlers),
    ballNumber: balls - 1
  });

  // ‚úÖ Ensure correct innings array exists
  if (!inningsHistory[currentInnings]) inningsHistory[currentInnings] = [];

  // ‚úÖ Add wicket event to correct innings
  inningsHistory[currentInnings].push({
    type: 'wicket',
    over: Math.floor(balls / 6),
    ball: balls % 6,
    batsman: batsman.name,
    bowler: bowler.name,
    score,
    wickets
  });

  // üîä Sound and Commentary
  const wicketSound = document.getElementById("soundWicket");
  if (wicketSound && !isMuted) {
    wicketSound.currentTime = 0;
    wicketSound.play();
  }
  speakCommentary("wicket");
  showUmpireCall("wicket");

  // ‚ûï New Batsman or End Innings
  if (wickets < totalWickets) {
    let newBatsmanName = prompt("Enter name of new batsman:");
    if (!newBatsmanName) newBatsmanName = `Batsman ${wickets + 1}`;
    currentBatsmanIndex = batsmen.length;
    batsmen.push({
      name: newBatsmanName,
      runs: 0,
      balls: 0,
      fours: 0,
      sixes: 0,
      dotBalls: 0,
      out: false
    });
  } else {
    alert("All out!");
  }

  updateDisplay();
  renderScoreboard();
  checkInningsEnd();
  checkTargetReached();
  saveMatchState();
  renderOverSummary();
}
function checkOverComplete() {
  if (balls > 0 && balls % 6 === 0) {
    const lastBowler = bowlers[currentBowlerIndex];
    const last6Balls = ballHistory.slice(-6);

    // ‚úÖ FIX: Proper parentheses for maiden over check
    const isMaiden = last6Balls.length === 6 && last6Balls.every(b => 
      (b.type === 'run' && b.runs === 0) || b.type === 'legbye'
    );

    if (isMaiden) {
      speakCommentary("maiden");
      showMaidenMessage();
      if (!isMuted) {
        const maidenSound = document.getElementById("soundMaiden");
        if (maidenSound) {
          maidenSound.currentTime = 0;
          maidenSound.play();
        }
      }
    }

    if (isInningsOver()) {
      alert("Overs completed!");
      return;
    }

    let newBowler = prompt("Over completed. Enter new bowler name:");
    if (!newBowler) newBowler = `Bowler ${bowlers.length + 1}`;
    bowlers.push({
      name: newBowler,
      balls: 0,
      runs: 0,
      dotBalls: 0,
      wickets: 0
    });
    currentBowlerIndex = bowlers.length - 1;
  }
}
 function showMatchInnings() {
  const container = document.getElementById("matchInnings");
  container.innerHTML = "";  // Clear previous highlights

  inningsHistory.forEach((innings, index) => {
    if (!innings || innings.length === 0) return;  // Skip empty innings

    const section = document.createElement("div");
    section.className = "bg-white p-4 rounded shadow border mb-4";

    const title = document.createElement("h4");
    title.textContent = `üèè Innings ${index + 1} Highlights`;
    title.className = "text-lg font-bold mb-2 text-blue-700";
    section.appendChild(title);

    const table = document.createElement("table");
    table.className = "w-full text-sm border-collapse";
    table.innerHTML = `
      <thead class="bg-gray-100">
        <tr>
          <th class="border px-2 py-1">Over.Ball</th>
          <th class="border px-2 py-1">Event</th>
          <th class="border px-2 py-1">Batsman</th>
          <th class="border px-2 py-1">Bowler</th>
          <th class="border px-2 py-1">Score</th>
        </tr>
      </thead>
      <tbody></tbody>
    `;

    const tbody = table.querySelector("tbody");

    innings.forEach(event => {
      const overBall = `${event.over}.${event.ball}`;
      const type = event.type === "run" ? `${event.runs} run(s)` :
                   event.type === "wicket" ? "WICKET" :
                   event.type === "wide" ? "Wide" :
                   event.type === "legbye" ? "Leg Bye" :
                   event.type;

      const row = document.createElement("tr");
      row.innerHTML = `
        <td class="border px-2 py-1">${overBall}</td>
        <td class="border px-2 py-1">${type}</td>
        <td class="border px-2 py-1">${event.batsman}</td>
        <td class="border px-2 py-1">${event.bowler}</td>
        <td class="border px-2 py-1">${event.score}/${event.wickets}</td>
      `;
      tbody.appendChild(row);
    });

    section.appendChild(table);
    container.appendChild(section);
  });

  // ‚úÖ Optional: Scroll to the highlights section when showing
  container.scrollIntoView({ behavior: "smooth" });
}
function renderOverSummary() {
  const overContainer = document.getElementById("overSummary");
  overContainer.innerHTML = ""; // Clear previous

  let oversMap = {};

  [...ballHistory].reverse().forEach(ball => {
    const overNum = Math.floor(ball.ballNumber / 6);
    if (!oversMap[overNum]) oversMap[overNum] = [];
    oversMap[overNum].unshift(ball);
  });

  Object.keys(oversMap)
    .sort((a, b) => b - a)
    .forEach(over => {
      const balls = oversMap[over];
      let total = 0;

      const row = document.createElement("div");
      row.className = "flex items-center justify-start flex-wrap gap-2 bg-black text-white px-4 py-2 rounded-lg shadow-md mb-2";

      const label = document.createElement("div");
      label.textContent = `Ov ${over}`;
      label.className = "w-14 font-semibold text-gray-400";
      row.appendChild(label);

      balls.forEach(ball => {
        const el = document.createElement("div");
        el.className = "w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold";

        if (ball.type === "run") {
          el.textContent = ball.runs;
          total += ball.runs;
          el.classList.add("bg-gray-800");
          if (ball.runs === 4) el.classList.add("bg-blue-500");
          if (ball.runs === 6) el.classList.add("bg-green-500");
        } else if (ball.type === "wicket") {
          el.textContent = "W";
          el.classList.add("bg-red-600");
        } else if (ball.type === "wide") {
          el.textContent = "Wd";
          total += 1;
          el.classList.add("bg-yellow-400", "text-black");
        } else if (ball.type === "legbye") {
          el.textContent = "Lb";
          total += 1;
          el.classList.add("bg-purple-600");
        }

        row.appendChild(el);
      });

      const totalEl = document.createElement("div");
      totalEl.textContent = `= ${total}`;
      totalEl.className = "ml-auto text-white font-semibold";
      row.appendChild(totalEl);

      overContainer.appendChild(row);
    });
}
function isInningsOver() {
 return wickets >= totalWickets || balls >= totalOvers * 6;
}
function checkInningsEnd() {
  if (isInningsOver()) {
    alert(`Innings over! Total Score: ${score}/${wickets}`);

    if (inning === 1) {
      firstInningsScore = score;
      showMatchInnings();

      // ‚úÖ Show the manual "Start Second Innings" button
      document.getElementById("startSecondInningsBtn").classList.remove("hidden");
      
    } else {
      alert("Second innings over!");
      showMatchInnings();
      endMatch();
    }
  }
}
    
function startSecondInnings() {
  inning = 2;
  currentInnings = 1;
  inningsHistory[currentInnings] = [];

  // Reset match stats for 2nd innings
  score = 0;
  wickets = 0;
  balls = 0;
  extras = 0;
  dots = 0;
  legByeCount = 0;
  ballHistory = [];
  batsmen = [];
  bowlers = [];
  currentBatsmanIndex = 0;
  currentBowlerIndex = 0;

  // Prompt for new batsman and bowler
  let batsmanName = prompt("Enter name of first batsman for 2nd Innings:");
  if (!batsmanName) batsmanName = "Batsman 1";
  batsmen.push({
    name: batsmanName,
    runs: 0,
    balls: 0,
    fours: 0,
    sixes: 0,
    dotBalls: 0,
    out: false
  });

  let bowlerName = prompt("Enter name of first bowler for 2nd Innings:");
  if (!bowlerName) bowlerName = "Bowler 1";
  bowlers.push({
    name: bowlerName,
    balls: 0,
    runs: 0,
    wickets: 0,
    dotBalls: 0
  });

  // Update UI
  document.getElementById("inningLabel").textContent = `(2nd Innings)`;
  document.getElementById("targetInfo").textContent = `Target: ${firstInningsScore + 1} to win`;
  document.getElementById("targetInfo").classList.remove("hidden");

  // Hide 2nd innings start button
  document.getElementById("startSecondInningsBtn")?.classList.add("hidden")

  // Refresh UI
  updateDisplay();
  renderScoreboard();
  saveMatchState();

  alert("‚úÖ Second Innings Started!");
}
function checkTargetReached() {
  if (inning === 2 && score >= firstInningsScore + 1) {
    confetti(); // üéâ
    alert("üéØ Target Reached!");

    showMatchInnings();  // ‚úÖ Show both innings highlights

    // ‚úÖ Do NOT auto-call endMatch(), user will click manually.
  }
}

function endMatch() {
  const teamA = document.getElementById("teamA").value.trim();
  const teamB = document.getElementById("teamB").value.trim();

  if (inning === 1) {
    // üèÅ Switch to second innings
    firstInningsScore = score;
    inning = 2;
    currentInnings = 1;  // ‚úÖ Ensure all 2nd innings events go to inningsHistory[1]

    // ‚úÖ Initialize second innings history array
    inningsHistory[currentInnings] = [];

    localStorage.removeItem('crickMatchState');

    // Reset stats for 2nd innings
    score = 0;
    wickets = 0;
    balls = 0;
    extras = 0;
    dots = 0;
    legByeCount = 0;
    ballHistory = [];
    batsmen = [];
    bowlers = [];
    currentBatsmanIndex = 0;
    currentBowlerIndex = 0;

    let striker = prompt("Enter name of batsman for 2nd Innings:");
    if (!striker) striker = "Batsman 1";
    let bowlerName = prompt("Enter name of opening bowler for 2nd Innings:");
    if (!bowlerName) bowlerName = "Bowler 1";

    batsmen.push({ name: striker, runs: 0, balls: 0, fours: 0, sixes: 0, dotBalls: 0, out: false });
    bowlers.push({ name: bowlerName, balls: 0, runs: 0, dotBalls: 0, wickets: 0 });

    document.getElementById("inningLabel").textContent = `(2nd Innings)`;
    document.getElementById("targetInfo").textContent = `Target: ${firstInningsScore + 1} to win`;
    document.getElementById("targetInfo").classList.remove("hidden");

    updateDisplay();
    renderScoreboard();
    clearMatchState();
    document.getElementById("summary").classList.add("hidden");
  } else {
    // ‚úÖ Match ends after second innings
    let winnerText = "";
    if (score > firstInningsScore) {
      winnerText = `${teamB} won by ${totalWickets - wickets} wicket(s)!`;
    } else if (score < firstInningsScore) {
      winnerText = `${teamA} won by ${firstInningsScore - score} run(s)!`;
    } else {
      winnerText = "Match tied!";
    }

    const matchSummary = {
      teams: `${teamA} vs ${teamB}`,
      score1: `${firstInningsScore}/10 (max overs)`,
      score2: `${score}/${wickets}`,
      winner: winnerText,
      date: new Date().toLocaleString()
    };
    history.unshift(matchSummary);
    localStorage.setItem('crickHistory', JSON.stringify(history));
    document.getElementById("summary").classList.remove("hidden");
    document.getElementById("winner").textContent = winnerText;

    // üó£Ô∏è Voice Commentary
    const winnerName = (score > firstInningsScore) ? teamB : (score < firstInningsScore) ? teamA : null;
    if (winnerName) {
      const selectedLang = document.getElementById("voiceLang").value;
      let message = `Congratulations, ${winnerName}! You won the match!`;

      if (selectedLang === 'hi-IN') message = `‡§¨‡§ß‡§æ‡§à ‡§π‡•ã, ${winnerName}! ‡§Ü‡§™‡§®‡•á ‡§Æ‡•à‡§ö ‡§ú‡•Ä‡§§ ‡§≤‡§ø‡§Ø‡§æ ‡§π‡•à!`;
      else if (selectedLang === 'ta-IN') message = `‡Æµ‡Ææ‡Æ¥‡Øç‡Æ§‡Øç‡Æ§‡ØÅ‡Æï‡Æ≥‡Øç, ${winnerName}! ‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡Øã‡Æü‡Øç‡Æü‡Æø‡ÆØ‡Æø‡Æ≤‡Øç ‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø ‡Æ™‡ØÜ‡Æ±‡Øç‡Æ±‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç!`;
      else if (selectedLang === 'te-IN') message = `‡∞Ö‡∞≠‡∞ø‡∞®‡∞Ç‡∞¶‡∞®‡∞≤‡±Å, ${winnerName}! ‡∞Æ‡±Ä‡∞∞‡±Å ‡∞Æ‡±ç‡∞Ø‡∞æ‡∞ö‡±ç ‡∞ó‡±Ü‡∞≤‡∞ø‡∞ö‡∞æ‡∞∞‡±Å!`;

      const msg = new SpeechSynthesisUtterance(message);
      msg.lang = selectedLang;
      msg.volume = 1.0;
      msg.rate = 1.0;
      msg.pitch = 1.0;
      window.speechSynthesis.speak(msg);
    }

    // üéâ Winner UI
    const summaryDiv = document.getElementById("summary");
    summaryDiv.querySelectorAll(".text-2xl.text-green-600").forEach(el => el.remove());
    if (!winnerText.includes("tied")) {
      const winningTeam = score > firstInningsScore ? teamB : teamA;
      const congrats = document.createElement("p");
      congrats.className = "text-2xl text-green-600 font-bold mt-4 animate-bounce-in";
      congrats.textContent = "üéâ Congratulations to " + winningTeam + "!";
      summaryDiv.appendChild(congrats);
      confetti({ particleCount: 200, spread: 90, origin: { y: 0.6 } });
      if (!isMuted) document.getElementById("victorySound")?.play();
    }

    // üîÅ Play Again Button
    const playAgainContainer = document.getElementById("playAgainContainer");
    playAgainContainer.innerHTML = "";
    const playAgainBtn = document.createElement("button");
    playAgainBtn.id = "playAgainBtn";
    playAgainBtn.textContent = "üîÑ Play Again";
    playAgainBtn.className = "btn bg-blue-600 hover:bg-blue-700 mt-2";
    playAgainBtn.onclick = () => {
      clearMatchState();
      location.reload();
    };
    playAgainContainer.appendChild(playAgainBtn);

    // üìå Dot balls info
    summaryDiv.querySelectorAll("p.dot-info").forEach(p => p.remove());
    const dotInfo = document.createElement("p");
    dotInfo.className = "dot-info";
    dotInfo.textContent = `Total dot balls in match: ${dots}`;
    summaryDiv.appendChild(dotInfo);

    // üèÜ Highlights
    const topBatsman = batsmen.reduce((max, b) => b.runs > max.runs ? b : max, batsmen[0]);
    const topBowler = bowlers.reduce((max, b) => b.wickets > max.wickets ? b : max, bowlers[0]);
    const mostDotBowler = bowlers.reduce((max, b) => b.dotBalls > max.dotBalls ? b : max, bowlers[0]);

    let maidenOvers = 0;
    for (let i = 0; i < ballHistory.length; i += 6) {
      const over = ballHistory.slice(i, i + 6);
      if (over.length === 6 && over.every(b => (b.type === 'run' && b.runs === 0) || b.type === 'legbye')) {
        maidenOvers++;
      }
    }

    const highlights = document.getElementById("highlights");
    highlights.innerHTML = `
      <h4 class="text-lg font-semibold mb-1">üèÜ Match Highlights</h4>
      <ul class="list-disc ml-5 space-y-1">
        <li><strong>Top Batsman:</strong> ${topBatsman.name} - ${topBatsman.runs} runs (${topBatsman.balls} balls)</li>
        <li><strong>Top Bowler:</strong> ${topBowler.name} - ${topBowler.wickets} wickets</li>
        <li><strong>Most Dot Balls (Bowler):</strong> ${mostDotBowler.name} - ${mostDotBowler.dotBalls} dots</li>
        <li><strong>Total Dot Balls in Match:</strong> ${dots}</li>
        <li><strong>Maiden Overs:</strong> ${maidenOvers}</li>
      </ul>
    `;

    renderHistory();
    showMatchInnings();
    renderOverSummary();
  }
}

function updateDisplay() {
  document.getElementById("inningLabel").textContent = inning === 1 ? "(1st Innings)" : "(2nd Innings)";
  document.getElementById("score").textContent = `${score}/${wickets} (Extras: ${extras})`;
  document.getElementById("overs").textContent = `${Math.floor(balls / 6)}.${balls % 6}`;

  let runRate = balls > 0 ? (score / (balls / 6)) : 0;
  document.getElementById("runRate").textContent = runRate.toFixed(2);

  let oversLeft = Math.max(0, totalOvers - (balls / 6));
  document.getElementById("oversLeft").textContent = oversLeft.toFixed(1);

  const targetElement = document.getElementById("targetInfo");
  if (inning === 2 && targetElement) {
    const target = firstInningsScore + 1;
    const runsNeeded = Math.max(0, target - score);
    const ballsLeft = Math.max(0, totalOvers * 6 - balls);
    const reqRate = ballsLeft > 0 ? (runsNeeded / (ballsLeft / 6)) : 0;

    // Victory check handled elsewhere (but add UI hint here)
    let status = '';
    let color = 'text-yellow-700';
    if (runsNeeded === 0) {
      status = '‚úÖ Target Achieved!';
      color = 'text-green-700 font-bold';
    } else if (ballsLeft === 0 || wickets >= totalWickets) {
      status = '‚ùå All Out or Overs Finished';
      color = 'text-red-600 font-bold';
    } else {
      status = `${runsNeeded} needed from ${ballsLeft} balls`;
    }

    targetElement.innerHTML = `
      üéØ Target: ${target}<br>
      üèÉ Runs Needed: <span class="${color}">${runsNeeded}</span><br>
      ‚è≥ Balls Left: ${ballsLeft}<br>
      üìä Req. Run Rate: ${reqRate.toFixed(2)}<br>
      <span class="${color}">${status}</span>
    `;
    targetElement.classList.remove("hidden");
  } else if (targetElement) {
    targetElement.classList.add("hidden");
  }
}
    function promptNewBatsman() {
  let name = prompt("Enter name of new batsman:");
  if (!name) name = `Batsman ${wickets + 1}`;
  batsmen.push({
    name,
    runs: 0,
    balls: 0,
    fours: 0,
    sixes: 0,
    dotBalls: 0,
    out: false
  });
  currentBatsmanIndex = batsmen.length - 1;
}
function renderScoreboard() {
  const batsmanTable = document.getElementById("batsmanTable");
  batsmanTable.innerHTML = "";

  // Render Batsman Table
  batsmen.forEach(b => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td class="border px-2">${b.name}</td>
      <td class="border px-2">${b.runs}</td>
      <td class="border px-2">${b.balls}</td>
      <td class="border px-2">${b.dotBalls}</td>
      <td class="border px-2">${b.fours}</td>
      <td class="border px-2">${b.sixes}</td>
      <td class="border px-2">${b.out ? "Out" : "Not Out"}</td>
    `;
    batsmanTable.appendChild(tr);
  });

  const bowlerTable = document.getElementById("bowlerTable");
  bowlerTable.innerHTML = "";

  // Format overs helper
  function formatOvers(balls) {
    const completed = Math.floor(balls / 6);
    const extra = balls % 6;
    return `${completed}.${extra}`;
  }

  // Render Bowler Table in actual bowling order (no sort)
  bowlers.forEach((b, index) => {
    const overs = formatOvers(b.balls);
    const isCurrent = index === currentBowlerIndex;
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td class="border px-2">${b.name}${isCurrent ? " (current)" : ""}</td>
      <td class="border px-2">${overs}</td>
      <td class="border px-2">${b.runs}</td>
      <td class="border px-2">${b.dotBalls}</td>
      <td class="border px-2">${b.wickets}</td>
    `;
    bowlerTable.appendChild(tr);
  });
}
function undoLastBall() {
  if (ballHistory.length === 0) return alert("No balls to undo!");
  const lastBall = ballHistory.pop();
  score = lastBall.scoreBefore;
  wickets = lastBall.wicketsBefore;
  balls = lastBall.ballsBefore;
  batsmen = JSON.parse(lastBall.batsmenBefore);
  bowlers = JSON.parse(lastBall.bowlersBefore);
  if (lastBall.type === 'legbye') legByeCount = lastBall.legByeCountBefore;
  currentBatsmanIndex = batsmen.findIndex(b => !b.out);
if (currentBatsmanIndex === -1) currentBatsmanIndex = batsmen.length - 1;
  currentBowlerIndex = lastBall.bowlerIndex;
  updateDisplay();
  renderScoreboard();
  renderOverSummary();
}

function renderHistory() {
  const historyList = document.getElementById("matchHistory");
  historyList.innerHTML = "";
  if (history.length === 0) {
    historyList.innerHTML = "<li>No matches played yet.</li>";
    return;
  }
  history.forEach(match => {
    const li = document.createElement("li");
    li.textContent = `[${match.date}] ${match.teams} - 1st Innings: ${match.score1}, 2nd Innings: ${match.score2} => Winner: ${match.winner}`;
    historyList.appendChild(li);
  });
}

function clearHistory() {
  if (confirm("Are you sure you want to clear match history?")) {
    history = [];
    localStorage.removeItem('crickHistory');
    renderHistory();
  }
}

renderHistory();
function enableAudio() {
  const msg = new SpeechSynthesisUtterance("Audio enabled");
  msg.lang = 'en-US';
  window.speechSynthesis.speak(msg);
}
    let isMuted = false;
    document.addEventListener('DOMContentLoaded', () => {
  document.getElementById("muteBtn").textContent = isMuted ? "üîá Unmute" : "üîä Mute";
});

function toggleMute() {
  isMuted = !isMuted;
  const label = isMuted ? "üîá Unmute" : "üîä Mute";
  document.getElementById("muteBtn").textContent = label;

  // Mute/unmute all audio elements
  document.querySelectorAll("audio").forEach(audio => {
    audio.muted = isMuted;
  });
}
    function speakCommentary(messageKey) {
  const lang = document.getElementById("voiceLang").value;

  const commentaryMessages = {
    "dot": {
      "en-US": "That's a dot ball.",
      "hi-IN": "‡§Ø‡§π ‡§è‡§ï ‡§°‡•â‡§ü ‡§¨‡•â‡§≤ ‡§π‡•à‡•§",
      "ta-IN": "‡Æá‡Æ§‡ØÅ ‡Æí‡Æ∞‡ØÅ ‡Æü‡Ææ‡Æü‡Øç ‡Æ™‡Ææ‡Æ≤‡Øç.",
      "te-IN": "‡∞á‡∞¶‡∞ø ‡∞í‡∞ï ‡∞°‡∞æ‡∞ü‡±ç ‡∞¨‡∞æ‡∞≤‡±ç."
    },
    "one": {
      "en-US": "They take a single!",
      "hi-IN": "‡§è‡§ï ‡§∞‡§® ‡§≤‡§ø‡§Ø‡§æ!",
      "ta-IN": "‡Æí‡Æ∞‡ØÅ ‡Æ∞‡Æ©‡Øç ‡Æé‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æ©‡Æ∞‡Øç!",
      "te-IN": "‡∞í‡∞ï ‡∞™‡∞∞‡±Å‡∞ó‡±Å ‡∞§‡±Ä‡∞∏‡±Å‡∞ï‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞∞‡±Å!"
    },
    "two": {
      "en-US": "Two runs added!",
      "hi-IN": "‡§¶‡•ã ‡§∞‡§® ‡§ú‡•ã‡§°‡§º‡•á ‡§ó‡§è!",
      "ta-IN": "‡Æá‡Æ∞‡Æ£‡Øç‡Æü‡ØÅ ‡Æ∞‡Æ©‡Øç‡Æï‡Æ≥‡Øç !",
      "te-IN": "‡∞∞‡±Ü‡∞Ç‡∞°‡±Å ‡∞™‡∞∞‡±Å‡∞ó‡±Å‡∞≤‡±Å ‡∞ú‡±ã‡∞°‡∞ø‡∞Ç‡∞ö‡∞¨‡∞°‡±ç‡∞°‡∞æ‡∞Ø‡∞ø!"
    },
    "four": {
      "en-US": "That's a four!",
      "hi-IN": "‡§ö‡§æ‡§∞ ‡§∞‡§®!",
      "ta-IN": "‡Æ®‡Ææ‡Æ©‡Øç‡Æï‡ØÅ ‡Æ∞‡Æ©‡Øç!",
      "te-IN": "‡∞®‡∞æ‡∞≤‡±Å‡∞ó‡±Å ‡∞™‡∞∞‡±Å‡∞ó‡±Å‡∞≤‡±Å!"
    },
    "six": {
      "en-US": "That's a massive six!",
      "hi-IN": "‡§õ‡§ï‡•ç‡§ï‡§æ!",
      "ta-IN": "‡ÆÜ‡Æ±‡ØÅ ‡Æ∞‡Æ©‡Øç!",
      "te-IN": "‡∞Ü‡∞∞‡±Å ‡∞™‡∞∞‡±Å‡∞ó‡±Å‡∞≤‡±Å!"
    },
    "wicket": {
      "en-US": "It's a wicket!",
      "hi-IN": "‡§µ‡§ø‡§ï‡•á‡§ü ‡§ó‡§ø‡§∞‡§æ!",
      "ta-IN": "‡Æµ‡Æø‡Æï‡Øç‡Æï‡ØÜ‡Æü‡Øç ‡Æµ‡Æø‡Æ¥‡ØÅ‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ!",
      "te-IN": "‡∞µ‡∞ø‡∞ï‡±Ü‡∞ü‡±ç ‡∞™‡∞°‡∞ø‡∞™‡±ã‡∞Ø‡∞ø‡∞Ç‡∞¶‡∞ø!"
    },
    "wide": {
  "en-US": "That's a wide ball.",
  "hi-IN": "‡§Ø‡§π ‡§µ‡§æ‡§á‡§° ‡§¨‡•â‡§≤ ‡§π‡•à‡•§",
  "ta-IN": "‡ÆÖ‡Æ§‡ØÅ ‡ÆÖ‡Æï‡Æ≤ ‡Æ™‡Æ®‡Øç‡Æ§‡ØÅ.",
  "te-IN": "‡∞Ö‡∞¶‡∞ø ‡∞µ‡±à‡∞°‡±ç ‡∞¨‡∞æ‡∞≤‡±ç."
},
"legbye": {
  "en-US": "Lbw",
  "hi-IN": "‡§≤‡•á‡§ó ‡§¨‡§æ‡§Ø!",
  "ta-IN": "‡Æ≤‡ØÜ‡Æï‡Øç ‡Æµ‡Æø‡Æï‡Øç‡Æï‡ØÜ‡Æü‡Øç !",
  "te-IN": "‡∞≤‡±Ü‡∞ó‡±ç!"
},
    "maiden": {
  "en-US": "That's a maiden over!",
  "hi-IN": "‡§Ø‡§π ‡§Æ‡•á‡§°‡§® ‡§ì‡§µ‡§∞ ‡§π‡•à!",
  "ta-IN": "‡Æá‡Æ§‡ØÅ ‡Æí‡Æ∞‡ØÅ ‡ÆÆ‡Øá‡Æü‡Æ©‡Øç ‡Æì‡Æµ‡Æ∞‡Øç!",
  "te-IN": "‡∞á‡∞¶‡∞ø ‡∞í‡∞ï ‡∞Æ‡±Ü‡∞Ø‡∞ø‡∞°‡±Ü‡∞®‡±ç ‡∞ì‡∞µ‡∞∞‡±ç!"
},
  };

  const message = commentaryMessages[messageKey]?.[lang];
  if (!message) return;

  const utterance = new SpeechSynthesisUtterance(message);
  utterance.lang = lang;
  utterance.volume = 1;
  utterance.pitch = 1;
  utterance.rate = 1;
  if (!isMuted) window.speechSynthesis.speak(utterance);
}
    function showUmpireCall(type) {
  const call = document.getElementById("umpireCall");
  call.classList.remove("hidden");

  if (type === "wide") {
    call.textContent = "üëã Wide Ball!";
  } else if (type === "wicket") {
    call.textContent = "‚òùÔ∏è Out!";
  }

  call.classList.add("show");

  setTimeout(() => {
    call.classList.remove("show");
    call.classList.add("hidden");
  }, 1200); // visible for 1.2 seconds
}
    function showMaidenMessage() {
  const msg = document.getElementById("maidenMessage");
  msg.textContent = "üëè Maiden Over!";
  msg.classList.remove("hidden");

  setTimeout(() => {
    msg.classList.add("hidden");
  }, 2000);
}
    function toggleMatchInnings() {
  const container = document.getElementById("matchInnings");
  const button = document.getElementById("toggleMatchInningsBtn");

  const isHidden = container.style.display === "none" || container.classList.contains("hidden") || container.innerHTML === "";

  if (isHidden) {
    showMatchInnings(); // Build the highlights
    container.classList.remove("hidden");
    container.style.display = "block";
    button.textContent = "Hide Match Innings";
  } else {
    container.innerHTML = "";
    container.style.display = "none";
    button.textContent = "Show Match Innings";
  }
}
document.addEventListener("DOMContentLoaded", () => {
  document.getElementById("matchInnings").style.display = "none";
});

  </script>
  
   <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js')
        .then(reg => {
          console.log("‚úÖ Service Worker Registered");

          if (reg.waiting) {
            reg.waiting.postMessage({ type: 'SKIP_WAITING' });
            window.location.reload();
          }

          reg.addEventListener("updatefound", () => {
            const newSW = reg.installing;
            newSW.addEventListener("statechange", () => {
              if (newSW.state === "installed" && navigator.serviceWorker.controller) {
                newSW.postMessage({ type: 'SKIP_WAITING' });
                window.location.reload();
              }
            });
          });
        })
        .catch(err => console.error("‚ùå Service Worker registration failed", err));
    }
  </script>

  <!-- ‚úÖ Footer -->
  <footer class="text-center text-sm text-gray-500 mt-10">
    Developed by 
    <a 
      href="https://github.com/prem90902304" 
      target="_blank" 
      rel="noopener noreferrer"
      class="text-blue-600 hover:underline font-semibold"
    >
      prem
    </a> 
    ‚Ä¢ ¬© 2025 <span class="font-medium text-gray-700">RoomCrick</span>
  </footer>

  <!-- ‚úÖ Sound Effects -->
  <audio id="victorySound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-notification-2018.mp3"></audio>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const victorySound = document.getElementById("victorySound");
      if (victorySound) victorySound.volume = 0.4;
    });
  </script>

  <audio id="soundDot" src="https://assets.mixkit.co/sfx/preview/mixkit-soft-hit-football-kick-2357.mp3"></audio>
  <audio id="sound1" src="https://assets.mixkit.co/sfx/preview/mixkit-cricket-hit-2058.mp3"></audio>
  <audio id="sound2" src="https://assets.mixkit.co/sfx/preview/mixkit-quick-football-kick-2398.mp3"></audio>
  <audio id="sound4" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-notification-2018.mp3"></audio>
  <audio id="sound6" src="https://assets.mixkit.co/sfx/preview/mixkit-video-game-win-2016.mp3"></audio>
  <audio id="soundWide" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
  <audio id="soundLegBye" src="https://assets.mixkit.co/sfx/preview/mixkit-cartoon-slide-whistle-2400.mp3"></audio>
  <audio id="soundWicket" src="https://assets.mixkit.co/sfx/preview/mixkit-player-losing-or-failing-2042.mp3"></audio>
  <audio id="soundMaiden" src="https://assets.mixkit.co/sfx/preview/mixkit-fantasy-win-notification-2368.mp3"></audio>
  <audio id="soundToss" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.wav"></audio>

</body>
</html>
